version: "3"

# This .ci.yml file must be manually merged in eg:
#   docker-compose -f docker-compose.yml -f docker-compose.ci.yml up --detach

# Volumes are not supported in Github Actions

services:

  web:
    build:
      context: . 
      dockerfile: web.ci.Dockerfile
    environment:
      - SESSION_SECRET=yabbadabbadoo
      - G_AUTH_CLIENT_ID=XXCLIENTIDXX 
      - G_AUTH_CLIENT_SECRET=XXCLIENTSECRETXX
      - G_AUTH_CALLBACK=http://example.com
    ports:
      - "3000:3000"
    tty: true

  db:
    ports:
      - "5432:5432"